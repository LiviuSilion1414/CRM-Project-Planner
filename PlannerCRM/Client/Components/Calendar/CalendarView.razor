@using System.Globalization

<div class="calendar-container">
    <div class="calendar-header">
        <div class="navigation-buttons">
            <button class="btn btn-outline-primary" @onclick="PreviousPeriod">
                <i class="bi bi-chevron-left"></i>
            </button>
            <div>
                @foreach (var vt in Enum.GetValues(typeof(ViewType)))
                {
                    <button class="btn btn-outline-info @(GetViewClass((ViewType)vt)) mx-1" type="button" @onclick="@(() => SetView((ViewType)vt))">@vt</button>
                }
            </div>
            <button class="btn btn-outline-primary" @onclick="NextPeriod">
                <i class="bi bi-chevron-right"></i>
            </button>
        </div>
        <span class="text-center">@GetCurrentDateInfoByCurrentView()</span>
        <span class="rounded btn btn-outline-info pe-3" @onclick="GoToToday">Today</span>
    </div>

    <div class="calendar-main">
        @if (CurrentView == ViewType.Month)
        {
            <div class="calendar-grid">
                @foreach (var dayName in Enum.GetValues(typeof(DayNames)))
                {
                    <div class="calendar-day-name">@dayName</div>
                }
                @foreach (var day in CurrentMonthDays)
                {
                    <div class="calendar-day @GetDayClass(day)" style="position: relative;">
                        @if (day.HasValue)
                        {
                            foreach (var ev in _events)
                            {
                                @if (ev.StartDate.Day <= day && ev.EndDate.Day >= day)
                                {
                                    <div style="display: flex;">
                                        <br />
                                        <span style="position: relative; width: 100%; margin-bottom: 5px; color:white; background-color: @ev.Color;">@ev.Title</span>
                                    </div>
                                }
                            }
                            <span style="position: absolute; padding: 10px; top: 0; right: 0;">@day.Value</span>
                        }
                    </div>
                }
            </div>
        }
        else if (CurrentView == ViewType.Week)
        {
            <div class="calendar-week">
                @foreach (var day in CurrentWeekDays)
                {
                    <div class="calendar-week-day @GetDayClass(day.Day) mx-5 p-2" style="display: inline;">
                        <span>@day.DayOfWeek</span>
                        <span>@day.Day</span>
                    </div>
                }
            </div>
        }
        else if (CurrentView == ViewType.Day)
        {
            <div class="calendar-day-view">
                <h3>@CurrentDate.ToString("D", CultureInfo.InvariantCulture)</h3>
            </div>
        }
        else if (CurrentView == ViewType.Year)
        {
            <div class="calendar-year-grid">
                @for (int i = 1; i <= 12; i++)
                {
                    <div class="calendar-year-month mx-3 p-2" style="display: inline-block;">
                        <h5>@(new DateTime(CurrentDate.Year, i, 1).ToString("MMMM", CultureInfo.InvariantCulture))</h5>
                    </div>
                }
            </div>
        }
    </div>
</div>
